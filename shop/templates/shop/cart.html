{% extends "base.html" %}

{% block page_header %}
<section class="page-hero">
    <p class="eyebrow">Panier</p>
    <h1 class="page-title">Prêt à passer au paiement ?</h1>
    <p class="lead">Vérifie tes articles puis règle en ligne en une étape.</p>
</section>
{% endblock %}

{% block content %}
<div class="card soft" style="display:flex; gap:20px; flex-direction:column;">
    {% if items %}
        {% for item in items %}
        <div class="cart-line">
            <div class="cart-line-info">
                <div style="font-weight:600; font-size:16px;">{{ item.product.name }}</div>
                <div style="color:#cdd6f4; font-size:14px;">
                    {{ item.quantity }} × {{ item.product.price }} €
                </div>
            </div>
            <div class="cart-line-actions">
                <form method="post" action="{% url 'remove_from_cart' item.product.pk %}" class="shop-inline-form">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <input type="number" name="quantity" min="1" max="{{ item.quantity }}" value="1" class="qty-input" aria-label="Quantité à retirer">
                    <button type="submit" class="btn ghost">Retirer</button>
                </form>
                <form method="post" action="{% url 'add_to_cart' item.product.pk %}" class="shop-inline-form">
                    {% csrf_token %}
                    <input type="hidden" name="next" value="{{ request.path }}">
                    <input type="number" name="quantity" min="1" value="1" class="qty-input" aria-label="Quantité à ajouter">
                    <button type="submit" class="btn primary">Ajouter</button>
                </form>
            </div>
            <div class="cart-line-total">
                {{ item.total_price }} €
            </div>
        </div>
        {% endfor %}

        <div style="
            display:flex;
            justify-content:space-between;
            align-items:center;
            padding:18px 16px;
            border-radius:12px;
            background:#0d1b2a;
            color:#fff;
            box-shadow:0 10px 30px rgba(0,0,0,0.3);
        ">
            <div>
                <div style="font-size:13px; text-transform:uppercase; letter-spacing:0.05em; color:#9fb3c8;">Total</div>
                <div style="font-size:22px; font-weight:700;">{{ total }} €</div>
            </div>
            <a href="{% url 'checkout' %}" class="btn primary" style="padding:12px 18px; font-weight:700;">
                Passer au paiement
            </a>
        </div>
    {% else %}
        <div style="text-align:center; color:#cdd6f4; padding:24px;">
            Votre panier est vide. <a href="{% url 'shop' %}" class="link">Retour à la boutique</a>
        </div>
    {% endif %}
</div>
{% endblock %}
