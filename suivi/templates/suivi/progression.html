{% extends "base.html" %}
{% block title %}Progression{% endblock %}

{% block content %}

<div class="container mt-4">

    <h2 class="mb-4 text-center">üìà Progression des Entra√Ænements</h2>

    <div class="card shadow-sm">
        <div class="card-body">

            {% if labels %}
                <p class="text-muted">
                    Analyse des derni√®res semaines : nombre de s√©ances, dur√©e totale et charge totale.
                </p>

                <div class="mt-4">
                    <canvas id="progressChart" height="120"></canvas>
                </div>

            {% else %}
                <div class="alert alert-info text-center mb-0">
                    Aucune donn√©e disponible pour le moment.
                    <br>Commence par enregistrer tes s√©ances !
                </div>
            {% endif %}

        </div>
    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // R√©cup√©ration des donn√©es depuis Django
    const chartLabels = {{ labels|safe }};
    const sessionCounts = {{ session_counts|safe }};
    const durations = {{ durations|safe }};
    const totalWeight = {{ total_weight|safe }};  // nouvelle variable √† ajouter dans views.py

    const ctx = document.getElementById('progressChart');

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: chartLabels,
            datasets: [
                {
                    label: 'S√©ances',
                    data: sessionCounts,
                    borderColor: 'rgba(54, 162, 235, 0.8)',
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderWidth: 2,
                    tension: 0.3
                },
                {
                    label: 'Dur√©e totale (min)',
                    data: durations,
                    borderColor: 'rgba(255, 206, 86, 0.8)',
                    backgroundColor: 'rgba(255, 206, 86, 0.2)',
                    borderWidth: 2,
                    tension: 0.3
                },
                {
                    label: 'Charge totale (kg)',
                    data: totalWeight,
                    borderColor: 'rgba(75, 192, 192, 0.8)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderWidth: 2,
                    tension: 0.3
                }
            ]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { position: 'top' },
                tooltip: { mode: 'index', intersect: false }
            },
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>

{% endblock %}